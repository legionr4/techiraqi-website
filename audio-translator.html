<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO: Title and Description -->
    <title>مترجم الصوت | Tech_Iraqi</title>
    <meta name="description" content="ترجمة المقاطع الصوتية من لغة إلى أخرى مباشرة عبر موقع Tech_Iraqi باستخدام الذكاء الاصطناعي.">

    <!-- SEO: Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://techiraqi.netlify.app/audio-translator.html">
    <meta property="og:title" content="مترجم الصوت | Tech_Iraqi">
    <meta property="og:description" content="ترجمة المقاطع الصوتية من لغة إلى أخرى مباشرة عبر موقع Tech_Iraqi.">
    <meta property="og:image" content="https://techiraqi.netlify.app/FOX.png">

    <!-- SEO: Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://techiraqi.netlify.app/audio-translator.html">
    <meta property="twitter:title" content="مترجم الصوت | Tech_Iraqi">
    <meta property="twitter:description" content="ترجمة المقاطع الصوتية من لغة إلى أخرى مباشرة عبر موقع Tech_Iraqi.">
    <meta property="twitter:image" content="https://techiraqi.netlify.app/FOX.png">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/favicon.png">

    <!-- SEO: Canonical Link -->
    <link rel="canonical" href="https://techiraqi.netlify.app/audio-translator.html" />

    <!-- Font Awesome -->
    <!-- Asynchronously load Font Awesome for better performance -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"></noscript>

    <!-- AOS Library -->
    <!-- Asynchronously load AOS CSS for better performance -->
    <link rel="preload" href="https://unpkg.com/aos@next/dist/aos.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css"></noscript>

    <link rel="stylesheet" href="assets/css/style.css">
    <!-- FIX: Replaced old styles with new, more organized styles inspired by rc-design.html -->
    <style>
        /* --- Main Layout --- */
        .custom-translator {
            background-color: var(--card-bg-color);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            max-width: 1200px; /* Set a max-width for better readability on large screens */
            margin: 0 auto; /* Center the translator component */
        }

        .translator-layout {
            display: flex;
            flex-direction: column; /* Default for mobile */
            gap: 2rem;
        }

        .translator-controls {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .translator-results {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* --- Fieldset & Legend Styling (from rc-design.html) --- */
        fieldset {
            border: 1px solid var(--border-color);
            border-radius: 5px;
            margin-bottom: 0; /* Reset margin */
            padding: 10px;
            box-shadow: var(--container-shadow);
        }

        legend {
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background-color: var(--primary-color-faded);
            border-radius: 5px;
            color: var(--primary-hover);
            font-weight: 700;
            transition: background-color 0.3s ease;
            width: 100%;
            user-select: none;
        }

        .legend-icon {
            margin-left: 10px; /* RTL */
            font-size: 1.1em;
        }

        .toggle-icon {
            transition: transform 0.3s ease;
        }

        legend.collapsed .toggle-icon {
            transform: rotate(-90deg); /* RTL */
        }

        .collapsible-content {
            max-height: 1000px;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out, margin 0.5s ease-in-out;
            padding: 15px 5px 5px 5px;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .collapsible-content.collapsed {
            max-height: 0;
            padding-top: 0;
            padding-bottom: 0;
            margin-top: 0;
        }

        /* --- Input & Button Styling --- */
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .input-group label {
            font-weight: bold;
            color: var(--text-color);
        }

        .input-group input[type="file"], .input-group select, .input-group button {
            width: 100%;
            padding: 0.75rem;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background-color: var(--body-bg); /* Use a slightly different background for inputs */
            color: var(--text-color);
            font-size: 1rem;
        }

        .or-separator {
            text-align: center;
            margin: 0.5rem 0;
            color: var(--text-secondary-color);
        }

        .primary-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            font-size: 1.1rem;
        }

        .primary-btn:hover:not(:disabled) { background-color: #0056b3; }
        .primary-btn:disabled { background-color: #ccc; cursor: not-allowed; }

        /* --- Results Section --- */
        .result-box textarea { width: 100%; min-height: 120px; resize: vertical; padding: 0.75rem; border-radius: 4px; border: 1px solid var(--border-color); background-color: var(--background-color); color: var(--text-color); }
        #tts-output-container { display: flex; flex-direction: column; gap: 1rem; align-items: flex-start; }
        #tts-audio-player { width: 100%; }

        /* --- Loader & Messages --- */
        .translator-loader {
            position: absolute;
            inset: 0;
            background-color: rgba(249, 250, 251, 0.8); /* Light mode default with a slight tint */
            z-index: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            transition: background-color 0.3s;
            backdrop-filter: blur(4px); /* Add a blur effect */
        }

        body.dark-mode .translator-loader {
            background-color: rgba(17, 24, 39, 0.8);
        }

        .error-box {
            border-left: 6px solid #f44336;
            color: #b71c1c;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 4px;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode .error-box {
            background-color: #5d1a1a;
            border-left-color: #ef5350;
            color: #ffcdd2;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem; /* Space between header and textarea */
        }

        .result-header label {
            margin-bottom: 0; /* Override any default margins */
        }
        
        .icon-btn {
            background-color: transparent;
            border: none;
            cursor: pointer;
            color: var(--text-secondary-color);
            font-size: 1.2rem;
            padding: 5px;
            line-height: 1;
            transition: color 0.2s;
        }

        .icon-btn:hover:not(:disabled) {
            color: var(--primary-color);
        }

        /* --- Responsive Layout (Desktop) --- */
        @media (min-width: 992px) {
            .translator-layout {
                flex-direction: row;
                align-items: flex-start;
            }
            
            .translator-controls {
                flex: 1;
                min-width: 320px; /* Prevent controls from becoming too narrow */
                /* Replace bottom border with a right border for the two-column layout */
                border-bottom: none;
                padding-bottom: 0;
                border-right: 1px solid var(--border-color);
                padding-right: 2rem;
            }
            
            .translator-results {
                flex: 2;
            }
        }

        /* --- Mobile Adjustments --- */
        @media (max-width: 480px) {
            .custom-translator {
                padding: 1rem; /* Reduce padding on very small screens */
            }
            .primary-btn {
                font-size: 1rem; /* Adjust button font size for smaller screens */
                padding: 0.7rem 1.2rem;
            }
        }

        /* Utility class to hide elements accessibly */
        .hidden {
            display: none !important;
        }
        .progress-container {
            width: 80%;
            max-width: 400px;
            background-color: var(--border-color);
            border-radius: 5px;
            overflow: hidden;
            margin-top: 1rem;
        }
        .progress-bar {
            width: 0%;
            height: 10px;
            background-color: var(--primary-color);
            border-radius: 5px;
            transition: width 0.2s ease-in-out;
            height: 12px; /* Make it a bit thicker */
        }
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }
        .action-buttons .primary-btn {
            flex-grow: 1; /* Make the main button take up more space */
        }

        .secondary-btn {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 0.8rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
            flex-shrink: 0; /* Prevent the button from shrinking */
            line-height: 1; /* Align icon properly */
        }
        .secondary-btn:hover { background-color: #5a6268; }

        .record-btn-style { background-color: #5c677d; }
        .record-btn-style:hover:not(:disabled) { background-color: #4a5467; }

        .audio-preview-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
            width: 100%;
        }
        .audio-preview-container audio {
            flex-grow: 1;
            width: 0; /* Let flex-grow control the width */
        }

        .recording-status-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
            color: #d9534f; /* Red to indicate recording */
            font-weight: bold;
            font-size: 1.1rem;
        }

        .recording-indicator {
            width: 10px;
            height: 10px;
            background-color: #d9534f;
            border-radius: 50%;
            animation: pulse-animation 1.5s infinite ease-in-out;
        }

        @keyframes pulse-animation {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.25); opacity: 0.7; }
        }

        body.dark-mode .recording-status-container {
            color: #ef5350; /* A slightly brighter red for dark mode */
        }

        body.dark-mode .recording-indicator {
            background-color: #ef5350;
        }

        .audio-time-display {
            color: var(--text-secondary-color);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            font-family: monospace; /* Ensures numbers have the same width, preventing layout shifts */
        }
        .audio-status-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-top: 0.5rem;
            min-height: 24px; /* Reserve space to prevent layout shift */
        }

        .audio-error-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #d9534f; /* Red for error */
        }
        body.dark-mode .audio-error-container {
            color: #ef5350;
        }
        .audio-error-text {
            font-size: 0.9rem;
            font-weight: 500;
        }
    </style>

</head>
<body>

    <!-- Preloader -->
    <div id="preloader">
        <div class="spinner"></div>
    </div>

    <header>
        <div class="site-title"><a href="index.html">Tech_Iraqi</a></div>
        <button class="hamburger-menu" id="hamburger-button" aria-label="فتح أو إغلاق القائمة" aria-expanded="false">
            <span class="fas fa-bars" aria-hidden="true"></span>
        </button>
        <nav id="main-nav">
            <a href="index.html"><i class="fas fa-home nav-icon" aria-hidden="true"></i> الرئيسية</a>
            <a href="rc-designer/rc-design.html"><i class="fas fa-drafting-compass nav-icon" aria-hidden="true"></i> التصميم</a>
            <a href="audio-translator.html" class="active">
                <i class="fas fa-language nav-icon" aria-hidden="true"></i> مترجم الصوت
                <span class="nav-tooltip">ترجمة وتسجيل الصوت مباشرة</span>
            </a>
            <a href="blog.html"><i class="fas fa-blog nav-icon" aria-hidden="true"></i> المدونة</a>
            <a href="contact.html"><i class="fas fa-envelope nav-icon" aria-hidden="true"></i> اتصل بنا</a>
            <div class="login-container-mobile" data-netlify-identity-button></div>
        </nav>
        <div class="header-actions">
            <button class="theme-toggle-button desktop-theme-toggle" title="تفعيل الوضع الليلي">
                <i class="fas fa-moon" aria-hidden="true"></i>
            </button>
            <img src="assets/iraqFlog.gif" alt="علم العراق" class="header-flag">
            <div class="login-container-desktop" data-netlify-identity-button></div>
        </div>
    </header>

    <main>
        <div class="content-card hero-section" data-aos="fade-up">
            <h1>مترجم الصوت الفوري</h1>
            <p class="tagline">استخدم هذه الأداة لترجمة الكلام من لغة إلى أخرى. يمكنك رفع ملف صوتي أو التسجيل مباشرة من المايكروفون.</p>
        </div>

        <!-- New Custom Translator UI -->
        <div class="custom-translator" data-aos="fade-up" data-aos-delay="100">
            <div id="translator-loader" class="translator-loader hidden">
                <p id="loader-text">جاري المعالجة...</p>
                <div class="spinner"></div>
                <div id="progress-container" class="progress-container hidden">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>
            </div>

            <!-- New layout wrapper for responsive design -->
            <div class="translator-layout">
                <div class="translator-controls">
                    <fieldset>
                        <legend>
                            <div><i class="fas fa-microphone-alt legend-icon"></i><span>الخطوة 1: أدخل الصوت</span></div>
                            <i class="fas fa-chevron-down toggle-icon"></i>
                        </legend>
                        <div class="collapsible-content">
                            <div class="input-group">
                                <label for="audio-file-input">اختر ملف صوتي أو فيديو:</label>
                                <input type="file" id="audio-file-input" accept="audio/*,video/*">
                            </div>
                            <p class="or-separator">أو</p>
                            <button id="record-btn" class="primary-btn record-btn-style">سجل من المايكروفون <i class="fas fa-microphone"></i></button>
                            <div id="recording-status" class="recording-status-container hidden">
                                <span class="recording-indicator"></span>
                                <span id="recording-timer">00:00</span>
                            </div>
                            <div id="audio-preview-container" class="audio-preview-container hidden">
                                <audio id="recorded-audio-player" controls></audio>
                                <button id="clear-audio-btn" class="icon-btn" title="مسح المقطع">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend>
                            <div><i class="fas fa-cogs legend-icon"></i><span>الخطوة 2: إعدادات الترجمة</span></div>
                            <i class="fas fa-chevron-down toggle-icon"></i>
                        </legend>
                        <div class="collapsible-content">
                            <div class="input-group">
                                <label for="language-select">اختر لغة الترجمة:</label>
                                <select id="language-select">
                                    <option value="Modern Standard Arabic">Arabic (Modern Standard)</option>
                                    <option value="English">English</option>
                                    <option value="French">French</option>
                                    <option value="German">German</option>
                                    <option value="Spanish">Spanish</option>
                                    <option value="Russian">Russian</option>
                                    <option value="Mandarin Chinese">Chinese (Mandarin)</option>
                                    <option value="Japanese">Japanese</option>
                                    <option value="Italian">Italian</option>
                                    <option value="Hindi">Hindi</option>
                                    <option value="Bengali">Bengali</option>
                                    <option value="Catalan">Catalan</option>
                                    <option value="Czech">Czech</option>
                                    <option value="Danish">Danish</option>
                                    <option value="Dutch">Dutch</option>
                                    <option value="Estonian">Estonian</option>
                                    <option value="Finnish">Finnish</option>
                                    <option value="Indonesian">Indonesian</option>
                                    <option value="Korean">Korean</option>
                                    <option value="Maltese">Maltese</option>
                                    <option value="Western Persian">Persian (Western)</option>
                                    <option value="Polish">Polish</option>
                                    <option value="Portuguese">Portuguese</option>
                                    <option value="Romanian">Romanian</option>
                                    <option value="Slovak">Slovak</option>
                                    <option value="Swedish">Swedish</option>
                                    <option value="Swahili">Swahili</option>
                                    <option value="Tagalog">Tagalog</option>
                                    <option value="Telugu">Telugu</option>
                                    <option value="Thai">Thai</option>
                                    <option value="Turkish">Turkish</option>
                                    <option value="Ukrainian">Ukrainian</option>
                                    <option value="Urdu">Urdu</option>
                                    <option value="Northern Uzbek">Uzbek (Northern)</option>
                                    <option value="Vietnamese">Vietnamese</option>
                                    <option value="Welsh">Welsh</option>
                                </select>
                            </div>
                            <div id="voice-selection-group" class="input-group">
                                <label for="voice-select">اختر صوت الترجمة:</label>
                                <select id="voice-select">
                                    <option value="female" selected>صوت امرأة</option>
                                    <option value="male">صوت رجل</option>
                                    <option value="child">صوت طفل</option>
                                </select>
                            </div>
                            <div id="arabic-tts-note" class="input-group hidden" style="color: var(--text-secondary-color); font-size: 0.9rem; margin-top: -1rem;">
                                ملاحظة: اختيار الصوت غير متاح حاليًا للغة العربية.
                            </div>
                            <div class="input-group">
                                <label for="speed-select">سرعة صوت الترجمة:</label>
                                <select id="speed-select">
                                    <option value="0.75">بطيء</option>
                                    <option value="1.0" selected>عادي</option>
                                    <option value="1.25">سريع</option>
                                    <option value="1.5">سريع جداً</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>

                    <div class="action-buttons">
                        <button id="translate-btn" class="primary-btn" disabled>الخطوة 3: ترجم الآن <i class="fas fa-language"></i></button>
                        <button id="reset-btn" class="secondary-btn hidden" title="إعادة تعيين"><i class="fas fa-sync-alt"></i></button>
                    </div>
                </div>

                <div class="translator-results">
                    <div id="error-display" class="error-box hidden"></div>
                    <div class="result-box">
                        <div class="result-header">
                            <label for="transcribed-text">النص الأصلي (من الصوت):</label>
                            <button id="copy-transcribed-btn" class="icon-btn" title="نسخ النص الأصلي" disabled>
                                <i class="fas fa-clipboard"></i>
                            </button>
                        </div>
                        <textarea id="transcribed-text" readonly placeholder="سيظهر النص المأخوذ من الصوت هنا..."></textarea>
                    </div>
                    <div class="result-box">
                        <div class="result-header">
                            <label for="translated-text">النص المترجم:</label>
                            <button id="copy-btn" class="icon-btn" title="نسخ النص" disabled>
                                <i class="fas fa-clipboard"></i>
                            </button>
                        </div>
                        <textarea id="translated-text" readonly placeholder="ستظهر الترجمة هنا..."></textarea>
                    </div>
                    <div id="tts-output-container" class="result-box hidden">
                        <label>استمع للترجمة:</label>
                        <audio id="tts-audio-player" controls></audio>
                        <div class="audio-status-container">
                            <div class="audio-time-display">
                                <span id="current-time">00:00</span> / <span id="total-duration">00:00</span>
                            </div>
                            <div id="audio-error-container" class="audio-error-container hidden">
                                <span class="audio-error-text">فشل تحميل الصوت.</span>
                                <button id="retry-audio-btn" class="icon-btn" title="إعادة المحاولة">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                        </div>
                        <a id="download-tts-link" class="primary-btn hidden" download="translated_audio.wav" style="margin-top: 0.75rem;">تحميل الصوت <i class="fas fa-download"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <button class="back-to-top" title="العودة إلى الأعلى" aria-label="العودة إلى الأعلى"><i class="fas fa-arrow-up" aria-hidden="true"></i></button>

    <footer>
        <div class="social-icons">
            <a href="https://twitter.com/YourTwitterHandle" title="تابعنا على تويتر" target="_blank" rel="noopener noreferrer" aria-label="تابعنا على تويتر"><i class="fa-brands fa-x-twitter" aria-hidden="true"></i></a>
            <a href="https://linkedin.com/in/YourLinkedInProfile" title="تابعنا على لينكد إن" target="_blank" rel="noopener noreferrer" aria-label="تابعنا على لينكد إن"><i class="fa-brands fa-linkedin-in" aria-hidden="true"></i></a>
            <a href="https://github.com/legionr4" title="شاهد مشاريعنا على جيت هاب" target="_blank" rel="noopener noreferrer" aria-label="شاهد مشاريعنا على جيت هاب"><i class="fa-brands fa-github" aria-hidden="true"></i></a>
        </div>
        <div class="footer-links">
            <a href="privacy-policy.html">سياسة الخصوصية</a>
            <a href="terms-of-use.html">شروط الاستخدام</a>
        </div>
        <p class="copyright">جميع الحقوق محفوظة &copy; <span id="copyright-year">2025</span></p>
    </footer>

    <script src="assets/js/auth.js" defer></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js" defer></script>
    <script src="assets/js/script.js" defer></script>
    <script src="assets/js/audio-translator.js" defer></script>
</body>

</html>
